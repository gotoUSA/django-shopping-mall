# 🎯 주요 기능 (Features)

이 문서는 쇼핑몰 백엔드 API의 모든 기능을 상세하게 설명합니다.

---

## 📑 목차

1. [인증 시스템](#1-인증-시스템)
2. [이메일 인증](#2-이메일-인증)
3. [소셜 로그인](#3-소셜-로그인)
4. [상품 관리](#4-상품-관리)
5. [카테고리 시스템](#5-카테고리-시스템)
6. [상품 리뷰](#6-상품-리뷰)
7. [상품 문의 (Q&A)](#7-상품-문의-qa)
8. [장바구니](#8-장바구니)
9. [주문 관리](#9-주문-관리)
10. [결제 시스템](#10-결제-시스템)
11. [웹훅](#11-웹훅)
12. [포인트 시스템](#12-포인트-시스템)
13. [찜하기 (위시리스트)](#13-찜하기-위시리스트)
14. [알림 시스템](#14-알림-시스템)

---

## 1. 인증 시스템

### 1.1 회원가입
- **엔드포인트**: `POST /api/auth/register/`
- **기능**: 새로운 사용자 계정 생성
- **특징**:
  - 사용자명, 이메일, 비밀번호 필수
  - 비밀번호 강도 검증
  - 회원가입과 동시에 JWT 토큰 자동 발급
  - 추가 정보 입력 가능 (휴대폰 번호, 주소, 마케팅 수신 동의 등)
- **응답**: Access Token 및 Refresh Token

### 1.2 로그인
- **엔드포인트**: `POST /api/auth/login/`
- **기능**: 사용자 인증 및 토큰 발급
- **특징**:
  - JWT 기반 인증
  - Access Token (짧은 유효기간)
  - Refresh Token (긴 유효기간)
  - 마지막 로그인 IP 기록
- **응답**: Access Token, Refresh Token, 사용자 정보

### 1.3 로그아웃
- **엔드포인트**: `POST /api/auth/logout/`
- **기능**: 토큰 무효화
- **특징**:
  - Refresh Token을 블랙리스트에 추가
  - 보안 강화를 위한 토큰 폐기
- **인증 필요**: ✅

### 1.4 토큰 관리
#### 토큰 갱신
- **엔드포인트**: `POST /api/auth/token/refresh/`
- **기능**: 만료된 Access Token 재발급
- **특징**:
  - Refresh Token을 사용하여 새로운 Access Token 발급
  - Refresh Token도 갱신 가능

#### 토큰 검증
- **엔드포인트**: `GET /api/auth/token/verify/`
- **기능**: 토큰 유효성 확인
- **특징**:
  - 토큰 만료 여부 확인
  - 블랙리스트 체크
- **인증 필요**: ✅

### 1.5 프로필 관리
- **엔드포인트**: `GET/PUT/PATCH /api/auth/profile/`
- **기능**: 사용자 프로필 조회 및 수정
- **특징**:
  - 개인정보 조회 (이메일, 휴대폰, 주소 등)
  - 회원 등급 확인 (bronze/silver/gold/vip)
  - 보유 포인트 확인
  - 마케팅 수신 동의 설정
- **인증 필요**: ✅

### 1.6 비밀번호 변경
- **엔드포인트**: `POST /api/auth/password/change/`
- **기능**: 현재 비밀번호 확인 후 새 비밀번호로 변경
- **특징**:
  - 기존 비밀번호 확인 필수
  - 비밀번호 강도 검증
  - 변경 후 알림
- **인증 필요**: ✅

### 1.7 회원 탈퇴
- **엔드포인트**: `POST /api/auth/withdraw/`
- **기능**: 회원 탈퇴 (계정 비활성화)
- **특징**:
  - 비밀번호 재확인 필수
  - 회원 정보는 보존되지만 로그인 불가
  - 주문 이력 및 포인트 정보 유지
- **인증 필요**: ✅

---

## 2. 이메일 인증

### 2.1 인증 이메일 발송
- **엔드포인트**: `POST /api/auth/email/send/`
- **기능**: 이메일 인증 링크 발송
- **특징**:
  - UUID 기반 고유 토큰 생성
  - 이메일로 인증 링크 전송
  - 24시간 유효기간
  - 발송 이력 기록
- **인증 필요**: ✅

### 2.2 이메일 인증 확인
- **엔드포인트**: `POST /api/auth/email/verify/`
- **기능**: 인증 토큰으로 이메일 확인
- **특징**:
  - 토큰 유효성 검증
  - 만료 시간 확인
  - 인증 완료 시 사용자 계정 활성화
  - 인증 코드 또는 토큰 방식 지원

### 2.3 인증 이메일 재발송
- **엔드포인트**: `POST /api/auth/email/resend/`
- **기능**: 인증 이메일 재전송
- **특징**:
  - 기존 토큰 무효화
  - 새로운 토큰 생성 및 발송
  - 재발송 횟수 제한 (스팸 방지)
- **인증 필요**: ✅

### 2.4 인증 상태 조회
- **엔드포인트**: `GET /api/auth/email/status/`
- **기능**: 현재 이메일 인증 상태 확인
- **특징**:
  - 인증 완료 여부
  - 인증 대기 중인 토큰 정보
- **인증 필요**: ✅

---

## 3. 소셜 로그인

### 3.1 지원 플랫폼
- Google
- Kakao
- Naver

### 3.2 Google 로그인
- **엔드포인트**: `POST /api/auth/social/google/`
- **기능**: Google OAuth2를 통한 로그인
- **특징**:
  - Google 계정으로 간편 가입/로그인
  - 자동 프로필 정보 동기화
  - JWT 토큰 자동 발급

### 3.3 Kakao 로그인
- **엔드포인트**: `POST /api/auth/social/kakao/`
- **기능**: Kakao OAuth2를 통한 로그인
- **특징**:
  - 카카오 계정으로 간편 가입/로그인
  - 프로필 정보 자동 연동

### 3.4 Naver 로그인
- **엔드포인트**: `POST /api/auth/social/naver/`
- **기능**: Naver OAuth2를 통한 로그인
- **특징**:
  - 네이버 계정으로 간편 가입/로그인
  - 프로필 정보 자동 연동

### 3.5 소셜 로그인 특징
- 기존 계정과 자동 연결
- 소셜 계정 여러 개 연결 가능
- 소셜 로그인 후에도 일반 로그인 가능
- dj-rest-auth 및 allauth 기반 구현

---

## 4. 상품 관리

### 4.1 상품 목록 조회
- **엔드포인트**: `GET /api/products/`
- **기능**: 전체 상품 목록 조회
- **특징**:
  - 페이지네이션 (페이지당 12개)
  - 검색 기능
  - 필터링 기능
  - 정렬 기능
- **인증 필요**: ❌

### 4.2 상품 상세 조회
- **엔드포인트**: `GET /api/products/{id}/`
- **기능**: 특정 상품의 상세 정보 조회
- **특징**:
  - 상품 기본 정보
  - 카테고리 정보
  - 판매자 정보
  - 이미지 목록
  - 최근 리뷰 10개
  - 평균 평점 및 리뷰 수
  - 재고 상태
  - 찜 개수
- **인증 필요**: ❌

### 4.3 상품 생성
- **엔드포인트**: `POST /api/products/`
- **기능**: 새로운 상품 등록
- **특징**:
  - 판매자만 가능
  - 상품명, 가격, 재고, 카테고리 필수
  - slug 자동 생성 (한글 지원)
  - 중복 slug 자동 처리
  - 이미지 업로드 지원
- **인증 필요**: ✅ (판매자)

### 4.4 상품 수정
- **엔드포인트**: `PUT/PATCH /api/products/{id}/`
- **기능**: 상품 정보 수정
- **특징**:
  - 판매자 본인만 수정 가능
  - 부분 수정(PATCH) 지원
  - 가격, 재고, 설명 등 수정 가능
- **인증 필요**: ✅ (판매자)

### 4.5 상품 삭제
- **엔드포인트**: `DELETE /api/products/{id}/`
- **기능**: 상품 삭제
- **특징**:
  - 판매자 본인만 삭제 가능
  - 실제 DB 삭제 (주의 필요)
- **인증 필요**: ✅ (판매자)

### 4.6 검색 기능
- **쿼리 파라미터**: `?search={검색어}`
- **기능**: 상품명으로 검색
- **예시**: `/api/products/?search=노트북`

### 4.7 필터링 기능
#### 카테고리 필터
- **파라미터**: `?category={카테고리_ID}`
- **예시**: `/api/products/?category=1`

#### 가격 범위 필터
- **파라미터**: `?min_price={최소가격}&max_price={최대가격}`
- **예시**: `/api/products/?min_price=10000&max_price=50000`

#### 재고 있는 상품만
- **파라미터**: `?in_stock=true`
- **예시**: `/api/products/?in_stock=true`

#### 판매자별 필터
- **파라미터**: `?seller={판매자_ID}`
- **예시**: `/api/products/?seller=3`

### 4.8 정렬 기능
#### 최신순
- **파라미터**: `?ordering=-created_at`

#### 가격 낮은순
- **파라미터**: `?ordering=price`

#### 가격 높은순
- **파라미터**: `?ordering=-price`

#### 인기순 (판매량)
- **파라미터**: `?ordering=-sold_count`

### 4.9 특별 엔드포인트
#### 인기 상품
- **엔드포인트**: `GET /api/products/popular/`
- **기능**: 리뷰가 많은 상품 12개 조회
- **정렬**: 리뷰 수 많은 순

#### 평점 높은 상품
- **엔드포인트**: `GET /api/products/best_rating/`
- **기능**: 평점 높은 상품 12개 조회
- **조건**: 최소 3개 이상의 리뷰 보유
- **정렬**: 평균 평점 높은 순

#### 재고 부족 상품
- **엔드포인트**: `GET /api/products/low_stock/`
- **기능**: 판매자의 재고 부족 상품 조회
- **조건**: 재고 10개 이하
- **인증 필요**: ✅ (판매자)

### 4.10 페이지네이션
- 기본 페이지 크기: 12개
- 커스텀 페이지 크기: `?page_size={원하는_개수}`
- 최대 페이지 크기: 100개
- 페이지 이동: `?page={페이지_번호}`

---

## 5. 카테고리 시스템

### 5.1 카테고리 구조
- **특징**:
  - django-mptt 기반 계층 구조
  - 무제한 depth 지원
  - 부모-자식 관계 자동 관리

### 5.2 카테고리 목록 조회
- **엔드포인트**: `GET /api/categories/`
- **기능**: 전체 카테고리 목록
- **특징**:
  - 활성화된 카테고리만 조회
  - 상품 수 포함
- **인증 필요**: ❌

### 5.3 카테고리 상세 조회
- **엔드포인트**: `GET /api/categories/{id}/`
- **기능**: 특정 카테고리 정보 조회
- **특징**:
  - 상위 카테고리 정보
  - 하위 카테고리 목록
  - 해당 카테고리의 상품 수
- **인증 필요**: ❌

### 5.4 계층형 카테고리 트리
- **엔드포인트**: `GET /api/categories/tree/`
- **기능**: 전체 카테고리를 트리 구조로 조회
- **특징**:
  - 모든 depth의 카테고리 포함
  - 부모-자식 관계 표현
  - 프론트엔드 네비게이션 메뉴용
- **인증 필요**: ❌

### 5.5 카테고리별 상품 조회
- **엔드포인트**: `GET /api/categories/{id}/products/`
- **기능**: 특정 카테고리의 상품 목록
- **특징**:
  - 하위 카테고리 상품도 포함
  - 페이지네이션 지원
  - 검색/필터/정렬 적용 가능
- **인증 필요**: ❌

---

## 6. 상품 리뷰

### 6.1 리뷰 목록 조회
- **엔드포인트**: `GET /api/products/{id}/reviews/`
- **기능**: 특정 상품의 리뷰 목록 조회
- **특징**:
  - 페이지네이션 지원
  - 정렬 기능 (최신순, 평점순)
  - 작성자 정보 포함
- **인증 필요**: ❌

### 6.2 리뷰 작성
- **엔드포인트**: `POST /api/products/{id}/add_review/`
- **기능**: 상품 리뷰 작성
- **특징**:
  - 평점 (1~5) 필수
  - 리뷰 내용 작성
  - 한 상품당 사용자 1개만 작성 가능
  - 중복 리뷰 방지
- **인증 필요**: ✅

### 6.3 리뷰 정렬
#### 최신순
- **파라미터**: `?ordering=-created_at`

#### 오래된 순
- **파라미터**: `?ordering=created_at`

#### 평점 높은순
- **파라미터**: `?ordering=-rating`

#### 평점 낮은순
- **파라미터**: `?ordering=rating`

---

## 7. 상품 문의 (Q&A)

### 7.1 문의 목록 조회
- **엔드포인트**: `GET /api/products/{product_id}/questions/`
- **기능**: 특정 상품의 문의 목록 조회
- **특징**:
  - 비밀글은 작성자와 판매자만 조회 가능
  - 답변 여부 표시
  - 페이지네이션 지원
- **인증 필요**: ❌ (공개 문의) / ✅ (비밀 문의)

### 7.2 문의 작성
- **엔드포인트**: `POST /api/products/{product_id}/questions/`
- **기능**: 상품 문의 작성
- **특징**:
  - 제목, 내용 필수
  - 비밀글 설정 가능
  - 자동으로 상품 및 작성자 연결
- **인증 필요**: ✅

### 7.3 문의 상세 조회
- **엔드포인트**: `GET /api/products/{product_id}/questions/{id}/`
- **기능**: 특정 문의 상세 조회
- **특징**:
  - 비밀글은 작성자와 판매자만 조회 가능
  - 답변 포함
  - 수정/답변 가능 여부 표시
- **인증 필요**: ✅ (비밀글의 경우)

### 7.4 문의 수정
- **엔드포인트**: `PATCH /api/products/{product_id}/questions/{id}/`
- **기능**: 문의 내용 수정
- **특징**:
  - 작성자 본인만 수정 가능
  - 제목, 내용, 비밀글 여부 수정
  - 답변 등록 전에만 수정 가능
- **인증 필요**: ✅ (작성자)

### 7.5 문의 삭제
- **엔드포인트**: `DELETE /api/products/{product_id}/questions/{id}/`
- **기능**: 문의 삭제
- **특징**:
  - 작성자 본인만 삭제 가능
  - 답변이 있어도 삭제 가능 (답변도 함께 삭제)
- **인증 필요**: ✅ (작성자)

### 7.6 답변 작성
- **엔드포인트**: `POST /api/products/{product_id}/questions/{id}/answer/`
- **기능**: 문의에 대한 답변 작성
- **특징**:
  - 판매자만 답변 가능
  - 한 문의당 하나의 답변만
  - 답변 등록 시 자동으로 is_answered = True
  - 답변 등록 시 알림 발송
- **인증 필요**: ✅ (판매자)

### 7.7 답변 수정
- **엔드포인트**: `PATCH /api/products/{product_id}/questions/{id}/answer/`
- **기능**: 답변 내용 수정
- **특징**:
  - 답변 작성자(판매자)만 수정 가능
- **인증 필요**: ✅ (판매자)

### 7.8 답변 삭제
- **엔드포인트**: `DELETE /api/products/{product_id}/questions/{id}/answer/`
- **기능**: 답변 삭제
- **특징**:
  - 답변 작성자(판매자)만 삭제 가능
  - 삭제 시 is_answered = False로 변경
- **인증 필요**: ✅ (판매자)

### 7.9 내 문의 목록
- **엔드포인트**: `GET /api/my/questions/`
- **기능**: 로그인한 사용자가 작성한 모든 문의 조회
- **특징**:
  - 모든 상품의 문의 통합 조회
  - 답변 여부 필터링 가능
  - 페이지네이션 지원
- **인증 필요**: ✅

---

## 8. 장바구니

### 8.1 장바구니 조회
- **엔드포인트**: `GET /api/cart/`
- **기능**: 현재 사용자의 장바구니 전체 조회
- **특징**:
  - 장바구니 아이템 목록
  - 총 금액 계산
  - 총 아이템 수
  - 상품 정보 포함
- **인증 필요**: ✅

### 8.2 장바구니 요약
- **엔드포인트**: `GET /api/cart/summary/`
- **기능**: 장바구니 요약 정보
- **특징**:
  - 총 금액
  - 총 아이템 수
  - 간단한 정보만 반환 (빠른 조회)
- **인증 필요**: ✅

### 8.3 상품 추가
- **엔드포인트**: `POST /api/cart/add_item/`
- **기능**: 장바구니에 상품 추가
- **특징**:
  - 상품 ID와 수량 지정
  - 재고 확인
  - 동일 상품이 있으면 수량 증가
  - 재고 부족 시 오류 반환
- **인증 필요**: ✅

### 8.4 아이템 목록
- **엔드포인트**: `GET /api/cart/items/`
- **기능**: 장바구니 아이템 목록만 조회
- **특징**:
  - 각 아이템의 상세 정보
  - 소계 금액 포함
- **인증 필요**: ✅

### 8.5 아이템 수량 변경
- **엔드포인트**: `PATCH /api/cart/items/{id}/`
- **기능**: 장바구니 아이템의 수량 변경
- **특징**:
  - 수량 증가/감소
  - 재고 확인
  - 수량 0 입력 시 아이템 삭제
- **인증 필요**: ✅

### 8.6 아이템 삭제
- **엔드포인트**: `DELETE /api/cart/items/{id}/`
- **기능**: 장바구니에서 특정 아이템 삭제
- **특징**:
  - 즉시 삭제
  - 복구 불가
- **인증 필요**: ✅

### 8.7 장바구니 비우기
- **엔드포인트**: `POST /api/cart/clear/`
- **기능**: 장바구니의 모든 아이템 삭제
- **특징**:
  - confirm: true 파라미터 필수 (실수 방지)
  - 모든 아이템 일괄 삭제
- **인증 필요**: ✅

### 8.8 여러 상품 일괄 추가
- **엔드포인트**: `POST /api/cart/bulk_add/`
- **기능**: 여러 상품을 한 번에 장바구니에 추가
- **특징**:
  - items 배열로 여러 상품 전달
  - 각 상품의 재고 확인
  - 트랜잭션 처리 (전체 성공 또는 실패)
  - 일부 실패 시 에러 정보 포함
  - 찜 목록에서 여러 상품 담을 때 유용
- **인증 필요**: ✅

### 8.9 재고 확인
- **엔드포인트**: `GET /api/cart/check_stock/`
- **기능**: 장바구니 상품들의 재고 확인
- **특징**:
  - 주문 직전 재고 재확인
  - 품절 상품 알림
  - 재고 부족 상품 알림
  - 판매 중단 상품 알림
- **인증 필요**: ✅

---

## 9. 주문 관리

### 9.1 주문 목록 조회
- **엔드포인트**: `GET /api/orders/`
- **기능**: 사용자의 주문 목록 조회
- **특징**:
  - 최신순 정렬
  - 주문 상태별 필터링 가능
  - 페이지네이션 지원
- **인증 필요**: ✅

### 9.2 주문 생성
- **엔드포인트**: `POST /api/orders/`
- **기능**: 새로운 주문 생성
- **특징**:
  - 장바구니 상품 기반 주문 생성
  - 배송 정보 입력 필수
  - 포인트 사용 가능
  - 재고 확인 및 차감
  - 주문 번호 자동 생성 (날짜 기반)
  - 트랜잭션 처리로 데이터 무결성 보장
- **인증 필요**: ✅

### 9.3 주문 상세 조회
- **엔드포인트**: `GET /api/orders/{id}/`
- **기능**: 특정 주문의 상세 정보 조회
- **특징**:
  - 주문 아이템 목록
  - 배송 정보
  - 결제 정보
  - 주문 상태
- **인증 필요**: ✅

### 9.4 주문 수정
- **엔드포인트**: `PATCH /api/orders/{id}/`
- **기능**: 주문 정보 수정
- **특징**:
  - 결제 전에만 수정 가능
  - 배송지 정보 수정
- **인증 필요**: ✅

### 9.5 주문 취소
- **엔드포인트**: `POST /api/orders/{id}/cancel/`
- **기능**: 주문 취소
- **특징**:
  - 결제 완료 전: 즉시 취소
  - 결제 완료 후: 결제 취소 API 호출 필요
  - 배송 중/완료 상태는 취소 불가
  - 재고 자동 복구
  - 포인트 환불 (사용한 포인트)
  - 포인트 회수 (적립된 포인트)
- **인증 필요**: ✅

### 9.6 주문 상태
주문은 다음과 같은 상태를 가집니다:
- `pending`: 결제대기 (주문 생성 직후)
- `paid`: 결제완료
- `preparing`: 배송준비중
- `shipped`: 배송중
- `delivered`: 배송완료
- `canceled`: 주문취소
- `refunded`: 환불완료

---

## 10. 결제 시스템

토스페이먼츠(Toss Payments) 연동을 통한 결제 처리

### 10.1 결제 요청
- **엔드포인트**: `POST /api/payments/request/`
- **기능**: 결제 준비 및 정보 생성
- **특징**:
  - 토스 결제창 열기 전 호출
  - 주문 정보 기반 결제 정보 생성
  - 클라이언트 키 반환
  - success_url, fail_url 반환
  - 이메일 인증 필수
- **인증 필요**: ✅
- **응답**: 결제 정보 (payment_id, order_id, amount, client_key 등)

### 10.2 결제 승인
- **엔드포인트**: `POST /api/payments/confirm/`
- **기능**: 결제 최종 승인
- **특징**:
  - 토스 결제창에서 결제 완료 후 호출
  - 토스페이먼츠 API로 결제 승인 요청
  - 결제 성공 시 주문 상태 변경 (pending → paid)
  - 포인트 적립 (결제금액의 1%)
  - 장바구니 비우기
  - 결제 로그 기록
- **인증 필요**: ✅

### 10.3 결제 취소/환불
- **엔드포인트**: `POST /api/payments/cancel/`
- **기능**: 결제 취소 및 환불 처리
- **특징**:
  - 토스페이먼츠 API로 취소 요청
  - 재고 복구
  - 주문 상태 변경 (canceled)
  - 사용한 포인트 환불
  - 적립된 포인트 회수
  - 부분 취소 지원
  - 취소 사유 필수
- **인증 필요**: ✅

### 10.4 결제 목록 조회
- **엔드포인트**: `GET /api/payments/`
- **기능**: 내 결제 목록 조회
- **특징**:
  - 최신순 정렬
  - 결제 상태별 필터링 가능
  - 페이지네이션 지원
- **인증 필요**: ✅

### 10.5 결제 상세 조회
- **엔드포인트**: `GET /api/payments/{id}/`
- **기능**: 특정 결제 상세 정보 조회
- **특징**:
  - 결제 방법
  - 결제 금액
  - 카드 정보 (마스킹)
  - 승인 시간
  - 결제 로그 이력
- **인증 필요**: ✅

### 10.6 결제 실패
- **엔드포인트**: `POST /api/payments/fail/`
- **기능**: 결제 실패 처리
- **특징**:
  - 토스 결제창에서 실패 시 리다이렉트
  - 실패 사유 기록
  - 주문 상태는 pending 유지

### 10.7 결제 상태
- `pending`: 결제 대기
- `done`: 결제 완료
- `canceled`: 결제 취소
- `failed`: 결제 실패
- `aborted`: 결제 중단

### 10.8 결제 테스트 페이지
- **엔드포인트**: `GET /payment/test/{order_id}/`
- **기능**: 결제 테스트용 웹페이지
- **특징**:
  - 토스페이먼츠 결제창 테스트
  - 개발/테스트 환경용

---

## 11. 웹훅

### 11.1 토스페이먼츠 웹훅
- **엔드포인트**: `POST /api/webhooks/toss/`
- **기능**: 토스페이먼츠로부터 결제 이벤트 수신
- **특징**:
  - 비동기 결제 상태 변경 알림
  - 이벤트 타입 처리:
    - `PAYMENT_STATUS_CHANGED`: 결제 상태 변경
    - `PAYMENT_CANCELLATION_COMPLETE`: 결제 취소 완료
  - 자동 재고 복구
  - 자동 포인트 처리
  - 웹훅 로그 기록
- **인증 필요**: ❌ (토스페이먼츠 전용)

### 11.2 웹훅 이벤트 처리
#### 결제 승인 이벤트
- 결제 상태를 `done`으로 변경
- 주문 상태를 `paid`로 변경
- 포인트 적립

#### 결제 취소 이벤트
- 결제 상태를 `canceled`로 변경
- 주문 상태를 `canceled`로 변경
- 재고 복구
- 포인트 환불/회수

#### 결제 실패 이벤트
- 결제 상태를 `failed`로 변경
- 실패 사유 기록

---

## 12. 포인트 시스템

### 12.1 내 포인트 조회
- **엔드포인트**: `GET /api/points/my/`
- **기능**: 현재 보유 포인트 조회
- **특징**:
  - 총 보유 포인트
  - 회원 등급
- **인증 필요**: ✅

### 12.2 포인트 이력
- **엔드포인트**: `GET /api/points/history/`
- **기능**: 포인트 적립/사용/만료 이력 조회
- **특징**:
  - 시간순 정렬
  - 타입별 필터링 (earn/use/expire)
  - 각 이력의 상세 내용
  - 페이지네이션 지원
- **인증 필요**: ✅

### 12.3 사용 가능 포인트 확인
- **엔드포인트**: `POST /api/points/check/`
- **기능**: 특정 금액 사용 가능 여부 확인
- **특징**:
  - 보유 포인트와 비교
  - 사용 가능 여부 반환
- **인증 필요**: ✅

### 12.4 만료 예정 포인트
- **엔드포인트**: `GET /api/points/expiring/`
- **기능**: 곧 만료될 포인트 조회
- **특징**:
  - 7일 이내 만료 예정 포인트
  - 만료 날짜 표시
  - 만료 예정 알림용
- **인증 필요**: ✅

### 12.5 포인트 통계
- **엔드포인트**: `GET /api/points/statistics/`
- **기능**: 포인트 통계 정보 조회
- **특징**:
  - 총 적립 포인트
  - 총 사용 포인트
  - 만료된 포인트
  - 현재 보유 포인트
- **인증 필요**: ✅

### 12.6 포인트 적립
**자동 적립 시스템**:
- 결제 완료 시 자동 적립
- 적립률: 결제 금액의 1%
- 유효기간: 적립일로부터 365일

### 12.7 포인트 사용
**FIFO 방식**:
- 먼저 적립된 포인트부터 사용
- 만료 임박 포인트 우선 사용
- 주문 생성 시 사용 가능

### 12.8 포인트 만료
**자동 만료 시스템**:
- 적립일로부터 365일 후 자동 만료
- 만료 7일 전 알림 발송
- 매일 자동 만료 처리 (Celery 스케줄러)
- 만료 시 포인트 차감 및 이력 기록

### 12.9 포인트 환불/회수
**주문 취소 시**:
- 사용한 포인트 환불
- 적립된 포인트 회수 (보유 포인트 내에서)

### 12.10 포인트 타입
- `earn`: 적립 (주문 완료, 이벤트 등)
- `use`: 사용 (주문 시)
- `expire`: 만료 (유효기간 경과)
- `cancel_refund`: 주문 취소로 인한 환불
- `cancel_deduct`: 주문 취소로 인한 회수

---

## 13. 찜하기 (위시리스트)

### 13.1 찜 목록 조회
- **엔드포인트**: `GET /api/wishlist/`
- **기능**: 내 찜 목록 조회
- **특징**:
  - 상품 정보 포함
  - 정렬 기능 (최신순, 가격순 등)
  - 필터링 (구매 가능, 세일 중)
  - 페이지네이션 지원
- **인증 필요**: ✅

### 13.2 찜하기 토글
- **엔드포인트**: `POST /api/wishlist/toggle/`
- **기능**: 찜하기 추가/제거 토글
- **특징**:
  - 찜 상태가 아니면 추가
  - 찜 상태이면 제거
  - 한 번의 API 호출로 처리
  - 하트 버튼 구현에 적합
- **인증 필요**: ✅

### 13.3 찜 추가
- **엔드포인트**: `POST /api/wishlist/add/`
- **기능**: 찜 목록에 상품 추가
- **특징**:
  - 중복 추가 방지
  - 상품 존재 여부 확인
- **인증 필요**: ✅

### 13.4 찜 제거
- **엔드포인트**: `DELETE /api/wishlist/remove/`
- **기능**: 찜 목록에서 상품 제거
- **특징**:
  - 상품 ID로 제거
  - 존재하지 않으면 에러
- **인증 필요**: ✅

### 13.5 여러 상품 일괄 찜하기
- **엔드포인트**: `POST /api/wishlist/bulk_add/`
- **기능**: 여러 상품을 한 번에 찜 목록에 추가
- **특징**:
  - product_ids 배열로 전달
  - 중복 제외
  - 추가된 상품 수 반환
- **인증 필요**: ✅

### 13.6 찜 목록 전체 삭제
- **엔드포인트**: `DELETE /api/wishlist/clear/`
- **기능**: 찜 목록 전체 비우기
- **특징**:
  - 모든 찜 상품 삭제
  - 복구 불가
- **인증 필요**: ✅

### 13.7 찜 상태 확인
- **엔드포인트**: `GET /api/wishlist/check/`
- **기능**: 특정 상품의 찜 상태 확인
- **특징**:
  - product_id 파라미터로 조회
  - 찜 여부 boolean 반환
  - 하트 버튼 초기 상태 표시용
- **인증 필요**: ✅

### 13.8 찜 목록 통계
- **엔드포인트**: `GET /api/wishlist/stats/`
- **기능**: 찜 목록 통계 정보
- **특징**:
  - 총 찜 개수
  - 구매 가능한 상품 수
  - 총 가격
  - 평균 가격
- **인증 필요**: ✅

### 13.9 찜 → 장바구니 이동
- **엔드포인트**: `POST /api/wishlist/move_to_cart/`
- **기능**: 찜한 상품을 장바구니로 이동
- **특징**:
  - product_ids 배열로 전달 (선택 상품만)
  - 비어있으면 전체 이동
  - 재고 확인
  - 이동 후 찜 목록에서 제거
  - 장바구니에 추가 성공한 상품만 제거
- **인증 필요**: ✅

### 13.10 찜 목록 필터링
#### 구매 가능한 상품만
- **파라미터**: `?is_available=true`

#### 세일 중인 상품만
- **파라미터**: `?on_sale=true`

### 13.11 찜 목록 정렬
#### 최신순
- **파라미터**: `?ordering=-created_at`

#### 가격 낮은순
- **파라미터**: `?ordering=price`

#### 가격 높은순
- **파라미터**: `?ordering=-price`

---

## 14. 알림 시스템

### 14.1 알림 목록 조회
- **엔드포인트**: `GET /api/notifications/`
- **기능**: 내 알림 목록 조회
- **특징**:
  - 최신순 정렬
  - 읽음/읽지않음 구분
  - 알림 타입별 표시
  - 페이지네이션 지원
- **인증 필요**: ✅

### 14.2 알림 상세 조회
- **엔드포인트**: `GET /api/notifications/{id}/`
- **기능**: 특정 알림 상세 조회
- **특징**:
  - 조회 시 자동으로 읽음 처리
  - 알림 내용 전체 표시
- **인증 필요**: ✅

### 14.3 읽지 않은 알림 개수
- **엔드포인트**: `GET /api/notifications/unread/`
- **기능**: 읽지 않은 알림 개수 조회
- **특징**:
  - 빠른 응답
  - 최근 5개 알림 미리보기 포함
  - 헤더의 🔔 아이콘 뱃지용
- **인증 필요**: ✅

### 14.4 알림 읽음 처리
- **엔드포인트**: `POST /api/notifications/mark_read/`
- **기능**: 알림을 읽음으로 표시
- **특징**:
  - notification_ids 배열로 여러 개 처리
  - 빈 배열이면 전체 읽음 처리
  - 읽음 처리된 개수 반환
- **인증 필요**: ✅

### 14.5 읽은 알림 삭제
- **엔드포인트**: `DELETE /api/notifications/clear/`
- **기능**: 읽은 알림 전체 삭제
- **특징**:
  - 읽은 알림만 삭제
  - 읽지 않은 알림은 보존
  - 삭제된 개수 반환
- **인증 필요**: ✅

### 14.6 알림 타입
시스템에서 자동으로 생성되는 알림 타입:
- **order**: 주문 관련 (주문 완료, 배송 시작, 배송 완료 등)
- **payment**: 결제 관련 (결제 완료, 결제 취소 등)
- **inquiry**: 문의 관련 (답변 등록)
- **point**: 포인트 관련 (포인트 적립, 만료 예정)
- **promotion**: 프로모션/이벤트
- **system**: 시스템 공지

### 14.7 알림 자동 생성 시점
#### 주문 관련
- 주문 완료 시
- 결제 완료 시
- 배송 시작 시
- 배송 완료 시

#### 문의 관련
- 상품 문의 답변 등록 시

#### 포인트 관련
- 포인트 적립 시
- 포인트 만료 7일 전
- 포인트 만료 시

---

## 🔒 권한 시스템

### 인증 레벨
1. **인증 불필요** (AllowAny)
   - 상품 조회
   - 카테고리 조회
   - 상품 검색
   - 리뷰 조회

2. **인증 필요** (IsAuthenticated)
   - 프로필 관리
   - 장바구니 관리
   - 주문 생성
   - 찜하기
   - 리뷰 작성
   - 문의 작성

3. **소유자 권한** (IsOwnerOrReadOnly)
   - 상품 수정/삭제 (판매자 본인)
   - 문의 수정/삭제 (작성자 본인)
   - 주문 취소 (주문자 본인)

4. **판매자 권한**
   - 상품 등록
   - 재고 부족 상품 조회
   - 문의 답변 작성

5. **관리자 권한** (IsAdminUser)
   - Django Admin 접근
   - 모든 데이터 관리

---

## 🔔 실시간 기능

### 알림 시스템
- 주문 상태 변경 시 실시간 알림
- 문의 답변 등록 시 알림
- 포인트 적립/만료 알림

### 웹훅을 통한 비동기 처리
- 토스페이먼츠 결제 상태 변경
- 자동 재고 업데이트
- 자동 포인트 처리

---

## 🎨 추가 기능

### 페이지네이션
- 기본 페이지 크기: 12개 (상품), 20개 (기타)
- 커스텀 페이지 크기 지원
- 최대 페이지 크기 제한

### 검색 기능
- 상품명 검색
- 대소문자 구분 없음
- 부분 일치 지원

### 필터링
- 다중 필터 조합 가능
- 카테고리, 가격, 재고, 판매자 등
- URL 쿼리 파라미터 방식

### 정렬
- 최신순, 오래된순
- 가격순 (낮은순/높은순)
- 인기순 (판매량, 리뷰수)
- 평점순

---

## 📊 통계 및 분석

### 상품 통계
- 판매량 (sold_count)
- 평균 평점
- 리뷰 수
- 찜 개수

### 사용자 통계
- 총 주문 수
- 총 구매 금액
- 보유 포인트
- 회원 등급

### 포인트 통계
- 총 적립 포인트
- 총 사용 포인트
- 만료된 포인트
- 만료 예정 포인트

---

## 🔍 고급 기능

### 트랜잭션 & 동시성 처리
- 재고 차감 시 동시성 처리
- 주문 생성 시 트랜잭션 잠금 및 원자적 처리
- 결제 승인 시 데이터 무결성 보장
- 포인트 사용 시 race condition 방지

### 캐싱
- 카테고리 트리 캐싱
- 인기 상품 캐싱 (추후 구현 예정)

### 로깅
- 결제 로그 (PaymentLog)
- 이메일 발송 로그 (EmailLog)
- 웹훅 이벤트 로그

### 보안
- JWT 토큰 블랙리스트
- 비밀번호 해싱 (Argon2)
- CORS 설정
- XSS 방어
- CSRF 보호

---

## 📝 주요 모델 관계

```
User (사용자)
├── Order (주문) - 1:N
├── Cart (장바구니) - 1:1
├── PointHistory (포인트 이력) - 1:N
├── Notification (알림) - 1:N
├── ProductQuestion (상품 문의) - 1:N
├── ProductReview (상품 리뷰) - 1:N
└── Wishlist (찜하기) - M:N with Product

Product (상품)
├── Category (카테고리) - N:1
├── Seller (판매자/User) - N:1
├── ProductImage (이미지) - 1:N
├── ProductReview (리뷰) - 1:N
├── ProductQuestion (문의) - 1:N
├── CartItem (장바구니 아이템) - 1:N
└── OrderItem (주문 아이템) - 1:N

Order (주문)
├── User (주문자) - N:1
├── OrderItem (주문 아이템) - 1:N
└── Payment (결제) - 1:1

Payment (결제)
├── Order (주문) - 1:1
└── PaymentLog (결제 로그) - 1:N
```

---

## 🚀 성능 최적화

### 데이터베이스 최적화
- select_related(): Foreign Key 조회 최적화
- prefetch_related(): Many-to-Many 조회 최적화
- 인덱스 설정 (name, category, price 등)
- 복합 인덱스 활용

### 쿼리 최적화
- N+1 문제 해결
- 불필요한 쿼리 제거
- 집계 쿼리 활용 (Count, Avg 등)

### API 응답 최적화
- 필요한 필드만 반환
- 페이지네이션으로 데이터 분할
- 캐싱 활용 (추후 Redis 적용 예정)

---

이 문서에는 프로젝트의 모든 주요 기능이 포함되어 있으며, 각 기능의 엔드포인트, 동작 방식, 특징이 상세히 설명되어 있습니다.